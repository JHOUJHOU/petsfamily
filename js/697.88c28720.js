"use strict";(self["webpackChunkpetsfamily_vue"]=self["webpackChunkpetsfamily_vue"]||[]).push([[697],{1697:function(t,e,s){s.r(e),s.d(e,{default:function(){return A}});var a=s(6252),i=s(3577),n=s(9963);const l={class:"container mt-9 mb-lg-8 mb-6"},r=(0,a._)("p",{class:"fs-1 fs-md-6 text-center"},"購物車頁面",-1),c={class:"row"},o={class:"col-12"},d={class:"text-end"},u={class:"table table-striped table-hover align-middle"},h=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"text-start",width:"50"}),(0,a._)("th",{class:"text-start",width:"150"},"商品照片"),(0,a._)("th",{class:"text-start",width:"150"},"商品名稱"),(0,a._)("th",{class:"text-center",width:"200"},"數量"),(0,a._)("th",{class:"text-center",width:"150"},"單位"),(0,a._)("th",{class:"text-center",width:"150"},"小計")])],-1),m={class:"text-center align-items-center"},p=["onClick"],g={class:"text-start"},_={class:"text-start"},y={class:"text-center"},b={class:"input-group input-group-sm"},v=["onUpdate:modelValue","onChange","disabled"],x=["value"],w={class:"text-center"},C={class:"text-center"},f={class:"text-end"},k=(0,a._)("td",{colspan:"5",class:"text-end"},"總計",-1),L={class:"text-center"},$={class:"row"},D={class:"d-flex justify-content-between"},I=(0,a.Uk)("繼續購物"),j=(0,a.Uk)("下一步");function T(t,e,s,T,z,W){const q=(0,a.up)("dog-side-icon"),U=(0,a.up)("loading"),A=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(U,{active:z.isLoading,class:"fs-1 text-secondary"},{default:(0,a.w5)((()=>[(0,a.Wm)(q),(0,a.Wm)(q),(0,a.Wm)(q)])),_:1},8,["active"]),(0,a._)("div",l,[r,(0,a._)("div",c,[(0,a._)("div",o,[(0,a._)("div",d,[(0,a._)("button",{class:(0,i.C_)(["btn btn-outline-danger",{disabled:0===z.cartData.carts.length}]),type:"button",onClick:e[0]||(e[0]=(...t)=>W.removeAllCart&&W.removeAllCart(...t))},"清空購物車",2)]),(0,a._)("table",u,[h,(0,a._)("tbody",null,[z.cartData.carts?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(z.cartData.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id,class:"align-items-center"},[(0,a._)("td",m,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>W.delCartItem(e.id)}," x ",8,p)]),(0,a._)("td",g,[(0,a._)("div",{class:"rounded rounded-3",style:(0,i.j5)([{height:"100px",width:"100px","background-position":"center center","background-size":"cover"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),(0,a._)("td",_,(0,i.zw)(e.product.title),1),(0,a._)("td",y,[(0,a._)("div",b,[(0,a.wy)((0,a._)("select",{class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>W.updateCartItem(e),disabled:z.isLoadingItem===e.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(t=>(0,a._)("option",{value:t,key:`${t}-${e.id}`},(0,i.zw)(t),9,x))),64))],40,v),[[n.bM,e.qty]])])]),(0,a._)("td",w,(0,i.zw)(e.product.unit),1),(0,a._)("td",C,(0,i.zw)(t.$filters.toThousands(e.total)),1)])))),128)):(0,a.kq)("",!0)]),(0,a._)("tfoot",null,[(0,a._)("tr",f,[k,(0,a._)("td",L,(0,i.zw)(t.$filters.toThousands(z.cartData.total)),1)])])])])]),(0,a._)("div",$,[(0,a._)("ul",D,[(0,a._)("li",null,[(0,a.Wm)(A,{class:"btn btn-primary text-center",to:"/products"},{default:(0,a.w5)((()=>[I])),_:1})]),(0,a._)("li",null,[(0,a.Wm)(A,{class:(0,i.C_)(["btn btn-secondary text-center",{disabled:0===z.cartData.carts.length}]),to:"order"},{default:(0,a.w5)((()=>[j])),_:1},8,["class"])])])])])],64)}var z=s(4051),W={inject:["emitter"],data(){return{cartData:{carts:[]},isLoadingItem:"",isLoading:!1}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/cart";this.isLoading=!0,this.$http.get(t).then((t=>{setTimeout((()=>{this.isLoading=!1}),1e3),this.cartData=t.data.data}))},delCartItem(t){this.isLoadingItem=t,this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/cart/${t}`;this.$http.delete(e).then((t=>{setTimeout((()=>{this.isLoading=!1}),1e3),z.Z.emit("get-cart"),this.getCart(),t.data.success&&this.emitter.emit("push-message",{style:"primary",title:"刪除商品成功"}),this.isLoadingItem=""})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"刪除商品失敗"})}))},updateCartItem(t){const e=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/cart/${t.id}`,s={product_id:t.product_id,qty:t.qty};this.isLoadingItem=t.id,this.isLoading=!0,this.$http.put(e,{data:s}).then((t=>{setTimeout((()=>{this.isLoading=!1}),1e3),this.getCart(),t.data.success&&this.emitter.emit("push-message",{style:"primary",title:"更新商品數量成功"}),this.isLoadingItem=""})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"更新商品數量失敗"})}))},removeAllCart(){const t="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{setTimeout((()=>{this.isLoading=!1}),1e3),this.getCart(),z.Z.emit("get-cart"),t.data.success&&this.emitter.emit("push-message",{style:"primary",title:"商品已清空，回到商品列表繼續選購"}),this.$router.push("/products")})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"商品清空失敗"})}))},toThousands(t){const e=String(t).split("."),s=e[0],a=3*Math.ceil(s.length/3),i=s.padStart(a,"0").match(/\d{3}/g).join(",").replace(/^0+/,"");return e[1]?`${i}.${e[1]}`:i}},mounted(){this.getCart()}},q=s(3744);const U=(0,q.Z)(W,[["render",T]]);var A=U}}]);
//# sourceMappingURL=697.88c28720.js.map