"use strict";(self["webpackChunkpetsfamily_vue"]=self["webpackChunkpetsfamily_vue"]||[]).push([[500],{67:function(t,e,a){a.d(e,{Z:function(){return _}});var l=a(6252),o=a(3577),s=a(9963);const r={"aria-label":"Page navigation example"},d={class:"pagination"},i=(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous"},[(0,l._)("span",{"aria-hidden":"true"},"«")],-1),c=[i],n=["onClick"],p=(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next"},[(0,l._)("span",{"aria-hidden":"true"},"»")],-1),u=[p];function m(t,e,a,i,p,m){return(0,l.wg)(),(0,l.iD)("nav",r,[(0,l._)("ul",d,[(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_pre}])},c,2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,(t=>((0,l.wg)(),(0,l.iD)("li",{class:(0,o.C_)(["page-item",{active:t===a.pages.current_page}]),key:t+"page"},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((e=>m.changePage(t)),["prevent"])},(0,o.zw)(t),9,n)],2)))),128)),(0,l._)("li",{class:(0,o.C_)(["page-item",{disabled:!a.pages.has_next}])},u,2)])])}var b={props:["pages"],methods:{changePage(t){this.$emit("change-page",t)}}},g=a(3744);const h=(0,g.Z)(b,[["render",m]]);var _=h},1500:function(t,e,a){a.r(e),a.d(e,{default:function(){return Ft}});var l=a(6252),o=a(9963),s=a(3577);const r={class:"container mt-9 mb-lg-8 mb-6"},d={class:"text-end mb-4"},i={class:"table table-striped table-hover"},c=(0,l._)("thead",null,[(0,l._)("tr",{class:"text-center"},[(0,l._)("th",{scope:"col"},"照片"),(0,l._)("th",{scope:"col"},"商品分類"),(0,l._)("th",{scope:"col"},"商品子分類"),(0,l._)("th",{scope:"col"},"商品名稱"),(0,l._)("th",{scope:"col"},"原價"),(0,l._)("th",{scope:"col"},"售價"),(0,l._)("th",{scope:"col"},"單位"),(0,l._)("th",{scope:"col"},"是否啟用"),(0,l._)("th",{scope:"col"},"編輯/刪除")])],-1),n={style:{width:"200px"}},p={class:"text-center"},u={class:"text-center"},m={class:"text-center"},b={class:"text-center"},g={class:"text-center"},h={class:"text-center"},_={class:"text-center"},y={key:0,class:"text-success"},f={key:1},v={class:"text-center"},w={class:"btn-group"},U=["onClick"],P=["onClick"];function k(t,e,a,k,M,x){const C=(0,l.up)("pagination"),$=(0,l.up)("product-modal"),D=(0,l.up)("del-product-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("div",d,[(0,l._)("button",{class:"btn btn-secondary",type:"button",onClick:e[0]||(e[0]=(0,o.iM)((t=>x.openModal("isNew")),["prevent"]))}," 建立新的商品 ")]),(0,l._)("table",i,[c,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(M.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",n,[(0,l._)("div",{style:(0,s.j5)([{backgroundImage:`url(${t.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,l._)("td",p,(0,s.zw)(t.category),1),(0,l._)("td",u,(0,s.zw)(t.subcategory),1),(0,l._)("td",m,(0,s.zw)(t.title),1),(0,l._)("td",b,(0,s.zw)(t.origin_price),1),(0,l._)("td",g,(0,s.zw)(t.price),1),(0,l._)("td",h,(0,s.zw)(t.unit),1),(0,l._)("td",_,[t.is_enabled?((0,l.wg)(),(0,l.iD)("span",y,"啟用")):((0,l.wg)(),(0,l.iD)("span",f,"未啟用"))]),(0,l._)("td",v,[(0,l._)("div",w,[(0,l._)("button",{type:"button",class:"btn btn-primary btn-sm",onClick:(0,o.iM)((e=>x.openModal("edit",t)),["prevent"])}," 編輯 ",8,U),(0,l._)("button",{type:"button",class:"btn btn-danger btn-sm",onClick:(0,o.iM)((e=>x.openModal("delete",t)),["prevent"])}," 刪除 ",8,P)])])])))),128))])]),(0,l.Wm)(C,{pages:M.pagination,onChangePage:x.getProducts},null,8,["pages","onChangePage"])]),(0,l.Wm)($,{"temp-product":M.tempProduct,"is-new":M.isNew,onGetProducts:x.getProducts,ref:"productModal"},null,8,["temp-product","is-new","onGetProducts"]),(0,l.Wm)(D,{"temp-product":M.tempProduct,onGetProducts:x.getProducts,ref:"delProductModal"},null,8,["temp-product","onGetProducts"])],64)}const M={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},x={class:"modal-dialog modal-xl"},C={class:"modal-content border-0"},$=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{id:"productModalLabel",class:"modal-title"},[(0,l._)("span",null,"新增產品")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},V={class:"row"},z={class:"col-sm-4"},B={class:"mb-3"},I={class:"mb-3"},N=(0,l._)("label",{for:"imageUrl",class:"form-label"},"上傳主圖(擇一)",-1),j={class:"mb-3"},A=(0,l._)("p",null,"輸入主圖網址(擇一)",-1),G=["src"],Z={class:"mb-3"},H=(0,l._)("h3",null,"增加其他商品圖片",-1),L={key:0},Y={class:"mb-3"},F=(0,l._)("label",{for:"imageUrl",class:"form-label"},"上傳商品圖片(擇一)",-1),K={class:"mb-3"},W=(0,l._)("p",null,"輸入商品圖片網址(擇一)",-1),q=["onUpdate:modelValue"],E=["src"],J={class:"col-sm-8"},O={class:"mb-3"},Q=(0,l._)("label",{for:"title",class:"form-label"},"商品名稱",-1),R={class:"row"},S={class:"mb-3 col-md-6"},T=(0,l._)("label",{for:"category",class:"form-label"},"大分類",-1),X={class:"mb-3 col-md-3"},tt=(0,l._)("label",{for:"subcategory",class:"form-label"},"小分類",-1),et={class:"mb-3 col-md-3"},at=(0,l._)("label",{for:"price",class:"form-label"},"單位",-1),lt={class:"row"},ot={class:"mb-3 col-md-6"},st=(0,l._)("label",{for:"origin_price",class:"form-label"},"原價",-1),rt={class:"mb-3 col-md-6"},dt=(0,l._)("label",{for:"price",class:"form-label"},"售價",-1),it=(0,l._)("hr",null,null,-1),ct={class:"mb-3"},nt=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),pt={class:"mb-3"},ut=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),mt={class:"mb-3"},bt={class:"form-check"},gt=(0,l._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用",-1),ht={class:"modal-footer"},_t=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function yt(t,e,a,s,r,d){return(0,l.wg)(),(0,l.iD)("div",M,[(0,l._)("div",x,[(0,l._)("div",C,[$,(0,l._)("div",D,[(0,l._)("div",V,[(0,l._)("div",z,[(0,l._)("div",B,[(0,l._)("div",I,[N,(0,l._)("input",{type:"file",class:"form-control",id:"imageUrl",placeholder:"請上傳主圖",ref:"clearImage",onChange:e[0]||(e[0]=t=>d.upload("mainImage",t))},null,544)]),(0,l._)("div",j,[A,r.product.imageUrl?(0,l.kq)("",!0):(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"text",class:"form-control",id:"imageUrl","aria-describedby":"inputGroupFileAddon04","aria-label":"Upload",placeholder:"輸入主圖網址(擇一)","onUpdate:modelValue":e[1]||(e[1]=t=>r.product.imageUrl=t)},null,512)),[[o.nr,r.product.imageUrl]])]),(0,l._)("img",{class:"img-fluid mb-3",src:r.product.imageUrl,alt:""},null,8,G),(0,l._)("button",{type:"button",class:"btn btn-secondary w-100",onClick:e[2]||(e[2]=t=>r.product.imageUrl="")}," 刪除主圖 ")]),(0,l._)("div",Z,[H,Array.isArray(r.product.imagesUrl)?((0,l.wg)(),(0,l.iD)("div",L,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.product.imagesUrl,((t,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a+"123456"},[(0,l._)("div",Y,[F,(0,l._)("input",{type:"file",class:"form-control",id:"imageUrl",placeholder:"上傳商品圖片",ref_for:!0,ref:"clearImage",onChange:e[3]||(e[3]=t=>d.upload("subImage",t))},null,544)]),(0,l._)("div",K,[W,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"imageUrl","aria-describedby":"inputGroupFileAddon04",placeholder:"輸入商品圖片網址(擇一)","aria-label":"Upload","onUpdate:modelValue":t=>r.product.imagesUrl[a]=t},null,8,q),[[o.nr,r.product.imagesUrl[a]]])]),(0,l._)("img",{class:"img-fluid mb-3",src:r.product.imagesUrl[a],alt:""},null,8,E)])))),128)),!r.product.imagesUrl.length||r.product.imagesUrl[r.product.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("button",{key:0,type:"button",class:"btn btn-primary w-100 mb-3",onClick:e[4]||(e[4]=t=>r.product.imagesUrl.push(""))},"增加圖片")):((0,l.wg)(),(0,l.iD)("button",{key:1,type:"button",class:"btn btn-danger w-100",onClick:e[5]||(e[5]=t=>r.product.imagesUrl.pop())},"刪除最後一張圖片"))])):(0,l.kq)("",!0)])]),(0,l._)("div",J,[(0,l._)("div",O,[Q,(0,l.wy)((0,l._)("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入商品名稱","onUpdate:modelValue":e[6]||(e[6]=t=>r.product.title=t)},null,512),[[o.nr,r.product.title]])]),(0,l._)("div",R,[(0,l._)("div",S,[T,(0,l.wy)((0,l._)("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=t=>r.product.category=t),placeholder:"請輸入子分類"},null,512),[[o.nr,r.product.category]])]),(0,l._)("div",X,[tt,(0,l.wy)((0,l._)("input",{id:"subcategory",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[8]||(e[8]=t=>r.product.subcategory=t)},null,512),[[o.nr,r.product.subcategory]])]),(0,l._)("div",et,[at,(0,l.wy)((0,l._)("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[9]||(e[9]=t=>r.product.unit=t)},null,512),[[o.nr,r.product.unit]])])]),(0,l._)("div",lt,[(0,l._)("div",ot,[st,(0,l.wy)((0,l._)("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[10]||(e[10]=t=>r.product.origin_price=t)},null,512),[[o.nr,r.product.origin_price]])]),(0,l._)("div",rt,[dt,(0,l.wy)((0,l._)("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[11]||(e[11]=t=>r.product.price=t)},null,512),[[o.nr,r.product.price]])])]),it,(0,l._)("div",ct,[nt,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[12]||(e[12]=t=>r.product.description=t)},"\n                    ",512),[[o.nr,r.product.description]])]),(0,l._)("div",pt,[ut,(0,l.wy)((0,l._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[13]||(e[13]=t=>r.product.content=t)},"\n                    ",512),[[o.nr,r.product.content]])]),(0,l._)("div",mt,[(0,l._)("div",bt,[gt,(0,l.wy)((0,l._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[14]||(e[14]=t=>r.product.is_enabled=t)},null,512),[[o.e8,r.product.is_enabled]])])])])])]),(0,l._)("div",ht,[_t,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:e[15]||(e[15]=(...t)=>d.updateProduct&&d.updateProduct(...t))}," 確認送出 ")])])])],512)}var ft=a(7424),vt=a.n(ft),wt={props:["tempProduct","isNew"],inject:["emitter"],data(){return{product:{},openBsModal:{}}},watch:{tempProduct(){this.product=this.tempProduct}},methods:{openModal(){this.openBsModal.show()},delModal(){this.openBsModal.show()},updateProduct(){let t="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/product",e="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/product/${this.tempProduct.id}`,e="put"),this.$http[e](t,{data:this.tempProduct}).then((t=>{this.$emit("get-products"),t.data.success&&this.emitter.emit("push-message",{style:"primary",title:"新增或編輯產品成功"}),this.openBsModal.hide()})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"新增或編輯產品失敗"})}))},upload(t,e){const a=e.target.files[0],l=new FormData;l.append("file-to-upload",a);const o="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/upload";this.$http.post(o,l).then((e=>{"mainImage"===t?(this.product.imageUrl=e.data.imageUrl,this.$refs.clearImage.value=""):"subImage"!==t||Array.isArray(this.product.imageUrl)||(this.product.imagesUrl=[],this.product.imagesUrl.push(e.data.imageUrl),this.$refs.clearImage.value=""),console.log(e.data.imagesUrl),e.data.success&&this.emitter.emit("push-message",{style:"primary",title:"上傳主圖成功"})})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"新增或編輯產品失敗"})}))}},mounted(){this.openBsModal=new(vt())(this.$refs.productModal)}},Ut=a(3744);const Pt=(0,Ut.Z)(wt,[["render",yt]]);var kt=Pt;const Mt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},xt={class:"modal-dialog"},Ct={class:"modal-content border-0"},$t=(0,l._)("div",{class:"modal-header bg-danger text-white"},[(0,l._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,l._)("span",null,"刪除產品")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Dt={class:"modal-body"},Vt=(0,l.Uk)(" 是否刪除 "),zt={class:"text-danger"},Bt=(0,l.Uk)(" 商品(刪除後將無法恢復)。 "),It={class:"modal-footer"},Nt=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function jt(t,e,a,o,r,d){return(0,l.wg)(),(0,l.iD)("div",Mt,[(0,l._)("div",xt,[(0,l._)("div",Ct,[$t,(0,l._)("div",Dt,[Vt,(0,l._)("strong",zt,(0,s.zw)(a.tempProduct.title),1),Bt]),(0,l._)("div",It,[Nt,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>d.delProduct&&d.delProduct(...t))}," 確認刪除 ")])])])],512)}var At={props:["tempProduct"],data(){return{product:{},openBsModal:{}}},methods:{openModal(){this.openBsModal.show()},delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/product/${this.tempProduct.id}`;this.$http.delete(t).then((()=>{this.$emit("get-products"),this.openBsModal.hide()}))}},mounted(){this.openBsModal=new(vt())(this.$refs.delProductModal)}};const Gt=(0,Ut.Z)(At,[["render",jt]]);var Zt=Gt,Ht=a(67),Lt={components:{productModal:kt,delProductModal:Zt,pagination:Ht.Z},data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,pagination:{}}},methods:{getProducts(t){const e=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/products/?page=${t}`;this.$http.get(e).then((t=>{console.log(t.data.products),this.products=t.data.products,this.pagination=t.data.pagination}))},openModal(t,e){"isNew"===t?(this.tempProduct={imagesUrl:[]},this.$refs.productModal.openModal(),this.isNew=!0):"edit"===t?(this.tempProduct={...e},this.$refs.productModal.openModal(),this.isNew=!1):"delete"===t&&(this.tempProduct={...e},this.$refs.delProductModal.openModal())}},mounted(){this.getProducts()}};const Yt=(0,Ut.Z)(Lt,[["render",k]]);var Ft=Yt}}]);
//# sourceMappingURL=500.4f04e393.js.map