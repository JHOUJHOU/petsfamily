"use strict";(self["webpackChunkpetsfamily_vue"]=self["webpackChunkpetsfamily_vue"]||[]).push([[860],{67:function(e,o,t){t.d(o,{Z:function(){return g}});var a=t(6252),n=t(3577),s=t(9963);const l={"aria-label":"Page navigation example"},d={class:"pagination"},i=(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous"},[(0,a._)("span",{"aria-hidden":"true"},"«")],-1),p=[i],c=["onClick"],u=(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next"},[(0,a._)("span",{"aria-hidden":"true"},"»")],-1),r=[u];function h(e,o,t,i,u,h){return(0,a.wg)(),(0,a.iD)("nav",l,[(0,a._)("ul",d,[(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!t.pages.has_pre}])},p,2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:(0,n.C_)(["page-item",{active:e===t.pages.current_page}]),key:e+"page"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((o=>h.changePage(e)),["prevent"])},(0,n.zw)(e),9,c)],2)))),128)),(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!t.pages.has_next}])},r,2)])])}var m={props:["pages"],methods:{changePage(e){this.$emit("change-page",e)}}},_=t(3744);const b=(0,_.Z)(m,[["render",h]]);var g=b},2860:function(e,o,t){t.r(o),t.d(o,{default:function(){return re}});var a=t(6252),n=t(9963),s=t(3577);const l={class:"container mt-9 mb-lg-8 mb-6"},d={class:"text-end mb-4"},i={class:"table table-striped table-hover align-middle"},p=(0,a._)("thead",null,[(0,a._)("tr",{class:"text-center"},[(0,a._)("th",{scope:"col"},"優惠卷項目"),(0,a._)("th",{scope:"col"},"折扣期限"),(0,a._)("th",{scope:"col"},"折扣百分比"),(0,a._)("th",{scope:"col"},"優惠卷折扣碼"),(0,a._)("th",{scope:"col"},"是否啟用")])],-1),c={class:"text-center"},u={class:"text-center"},r={class:"text-center"},h={class:"text-center"},m={class:"text-center"},_={key:0,class:"text-success"},b={key:1},g={class:"text-center"},v={class:"btn-group"},C=["onClick"],f=["onClick"];function y(e,o,t,y,w,M){const k=(0,a.up)("pagination"),x=(0,a.up)("coupon-modal"),D=(0,a.up)("del-coupon-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",l,[(0,a._)("div",d,[(0,a._)("button",{class:"btn btn-secondary",type:"button",onClick:o[0]||(o[0]=(0,n.iM)((e=>M.openModal("isNew")),["prevent"]))}," 建立新的優惠卷 ")]),(0,a._)("table",i,[p,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(w.coupons,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",c,(0,s.zw)(e.title),1),(0,a._)("td",u,(0,s.zw)(new Date(1e3*e.due_date).toLocaleDateString().split("T")[0]),1),(0,a._)("td",r,(0,s.zw)(e.percent)+"%",1),(0,a._)("td",h,(0,s.zw)(e.code),1),(0,a._)("td",m,[e.is_enabled?((0,a.wg)(),(0,a.iD)("span",_,"啟用")):((0,a.wg)(),(0,a.iD)("span",b,"未啟用"))]),(0,a._)("td",g,[(0,a._)("div",v,[(0,a._)("button",{type:"button",class:"btn btn-primary btn-sm",onClick:(0,n.iM)((o=>M.openModal("edit",e)),["prevent"])}," 編輯 ",8,C),(0,a._)("button",{type:"button",class:"btn btn-danger btn-sm",onClick:(0,n.iM)((o=>M.openModal("delete",e)),["prevent"])}," 刪除 ",8,f)])])])))),128))])]),(0,a.Wm)(k,{pages:w.pagination,onChangePage:M.getToCoupon},null,8,["pages","onChangePage"])]),(0,a.Wm)(x,{"temp-coupon":w.tempCoupon,"is-new":w.isNew,onGetCoupon:M.getToCoupon,ref:"couponModal"},null,8,["temp-coupon","is-new","onGetCoupon"]),(0,a.Wm)(D,{"temp-coupon":w.tempCoupon,onGetCoupon:M.getToCoupon,ref:"delCouponModal"},null,8,["temp-coupon","onGetCoupon"])],64)}var w=t(67);const M={id:"couponModal",ref:"couponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true"},k={class:"modal-dialog modal-md"},x={class:"modal-content border-0"},D=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{id:"couponModalLabel",class:"modal-title"},[(0,a._)("span",null,"優惠卷")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$={class:"modal-body"},B={class:"row"},L={class:"col-sm-12"},N={class:"mb-3"},T=(0,a._)("label",{for:"title",class:"form-label"},"優惠卷項目",-1),U={class:"mb-3"},W=(0,a._)("label",{for:"due_date",class:"form-label"},"折扣期限",-1),z={class:"mb-3"},P=(0,a._)("label",{for:"percent",class:"form-label"},"折扣百分比",-1),Z={class:"mb-3"},j=(0,a._)("label",{for:"code",class:"form-label"},"優惠卷折扣碼",-1),V={class:"mb-3"},G={class:"form-check"},H=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用",-1),Y={class:"modal-footer"},S=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function K(e,o,t,s,l,d){const i=(0,a.up)("dog-side-icon"),p=(0,a.up)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{active:l.isLoading,class:"fs-1 text-secondary"},{default:(0,a.w5)((()=>[(0,a.Wm)(i),(0,a.Wm)(i),(0,a.Wm)(i)])),_:1},8,["active"]),(0,a._)("div",M,[(0,a._)("div",k,[(0,a._)("div",x,[D,(0,a._)("div",$,[(0,a._)("div",B,[(0,a._)("div",L,[(0,a._)("div",N,[T,(0,a.wy)((0,a._)("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入優惠卷項目","onUpdate:modelValue":o[0]||(o[0]=e=>l.coupon.title=e)},null,512),[[n.nr,l.coupon.title]])]),(0,a._)("div",U,[W,(0,a.wy)((0,a._)("input",{id:"due_date",type:"text",class:"form-control",placeholder:"請輸入折扣期限","onUpdate:modelValue":o[1]||(o[1]=e=>l.due_date=e)},null,512),[[n.nr,l.due_date]])]),(0,a._)("div",z,[P,(0,a.wy)((0,a._)("input",{id:"percent",type:"text",class:"form-control",placeholder:"請輸入折扣百分比","onUpdate:modelValue":o[2]||(o[2]=e=>l.coupon.percent=e)},null,512),[[n.nr,l.coupon.percent,void 0,{number:!0}]])]),(0,a._)("div",Z,[j,(0,a.wy)((0,a._)("input",{id:"code",type:"text",class:"form-control",placeholder:"請輸入優惠卷折扣碼","onUpdate:modelValue":o[3]||(o[3]=e=>l.coupon.code=e)},null,512),[[n.nr,l.coupon.code]])]),(0,a._)("div",V,[(0,a._)("div",G,[H,(0,a.wy)((0,a._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[4]||(o[4]=e=>l.coupon.is_enabled=e)},null,512),[[n.e8,l.coupon.is_enabled]])])])])])]),(0,a._)("div",Y,[S,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:o[5]||(o[5]=(...e)=>d.updateCoupon&&d.updateCoupon(...e))}," 確認送出 ")])])])],512)],64)}var I=t(7424),O=t.n(I),q={props:["tempCoupon","isNew"],inject:["emitter"],data(){return{coupon:{is_enabled:0},openBsModal:{},due_date:"",isLoading:!1}},watch:{tempCoupon(){this.coupon=this.tempCoupon;const e=new Date(1e3*this.coupon.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.coupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{openModal(){this.openBsModal.show()},delModal(){this.openBsModal.show()},updateCoupon(){let e="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/coupon",o="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/coupon/${this.coupon.id}`,o="put"),this.isLoading=!0,this.$http[o](e,{data:this.coupon}).then((e=>{console.log(e.data),this.$emit("get-coupon"),setTimeout((()=>{this.isLoading=!1}),1e3),this.openBsModal.hide(),e.data.success&&this.emitter.emit("push-message",{style:"primary",title:"更新優惠卷成功"})})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"新增或編輯優惠卷失敗"})}))}},mounted(){this.openBsModal=new(O())(this.$refs.couponModal)}},A=t(3744);const E=(0,A.Z)(q,[["render",K]]);var F=E;const J={id:"delCouponModal",ref:"delCouponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delCouponModalLabel","aria-hidden":"true"},Q={class:"modal-dialog"},R={class:"modal-content border-0"},X=(0,a._)("div",{class:"modal-header bg-danger text-white"},[(0,a._)("h5",{id:"delCouponModalLabel",class:"modal-title"},[(0,a._)("span",null,"刪除優惠卷")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ee={class:"modal-body"},oe=(0,a.Uk)(" 是否刪除 "),te={class:"text-danger"},ae=(0,a.Uk)(" 商品(刪除後將無法恢復)。 "),ne={class:"modal-footer"},se=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function le(e,o,t,n,l,d){return(0,a.wg)(),(0,a.iD)("div",J,[(0,a._)("div",Q,[(0,a._)("div",R,[X,(0,a._)("div",ee,[oe,(0,a._)("strong",te,(0,s.zw)(t.tempCoupon.title),1),ae]),(0,a._)("div",ne,[se,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...e)=>d.delCoupon&&d.delCoupon(...e))}," 確認刪除 ")])])])],512)}var de={props:["tempCoupon"],data(){return{coupon:{},openBsModal:{}}},methods:{openModal(){this.openBsModal.show()},delCoupon(){const e=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(e).then((()=>{this.$emit("get-coupon"),this.openBsModal.hide()}))}},mounted(){this.openBsModal=new(O())(this.$refs.delCouponModal)}};const ie=(0,A.Z)(de,[["render",le]]);var pe=ie,ce={components:{couponModal:F,delCouponModal:pe,pagination:w.Z},data(){return{coupons:{},isNew:!1,tempCoupon:{is_enabled:0,due_date:""},pagination:{}}},methods:{getToCoupon(e=1){const o=`https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/admin/coupons/?page=${e}`;this.$http.get(o).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination}))},openModal(e,o){"isNew"===e?(this.tempCoupon={...o},this.tempCoupon={is_enabled:0,due_date:""},this.$refs.couponModal.openModal(),this.isNew=!0):"edit"===e?(this.tempCoupon={...o},this.$refs.couponModal.openModal(),this.isNew=!1):"delete"===e&&(this.tempCoupon={...o},this.$refs.delCouponModal.openModal())}},mounted(){this.getToCoupon()}};const ue=(0,A.Z)(ce,[["render",y]]);var re=ue}}]);
//# sourceMappingURL=860.66837b0c.js.map