"use strict";(self["webpackChunkpetsfamily_vue"]=self["webpackChunkpetsfamily_vue"]||[]).push([[294],{7294:function(e,t,s){s.r(t),s.d(t,{default:function(){return K}});var a=s(6252),l=s(3577),o=s(9963);const r={class:"container mt-9 mb-lg-8 mb-6"},i=(0,a._)("p",{class:"fs-1 fs-md-6 text-center mb-4 mb-md-4"},"確認訂單頁面",-1),c={class:"row"},d={class:"col-12 col-md-6 col-lg-6"},n=(0,a._)("p",{class:"fs-4 fs-md-6"},"訂單內容",-1),m={class:"table table-striped align-middle"},u=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"text-start"},"商品照片"),(0,a._)("th",{class:"text-start"},"商品名稱"),(0,a._)("th",{class:"text-center"},"數量"),(0,a._)("th",{class:"text-center"},"單項金額")])],-1),p={key:0},h={class:"text-start"},f={class:"text-start"},_={class:"text-center"},b={class:"text-center"},g={class:"row d-flex align-items-center"},v={class:"col-6"},y={class:"input-group mb-3"},x={class:"col-6 text-end"},w={key:0},k={key:1},C={class:"text-success text-opacity-50"},D={class:"fs-6 text-success"},V=(0,a.Uk)(" 使用折扣碼 : petCoupon85 "),W={class:"col-12 col-md-6 col-lg-6 justify-content-center"},T=(0,a._)("p",{class:"fs-4 fs-md-6"},"填寫訂單資訊",-1),$={class:"mb-2"},U=(0,a._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),j={class:"mb-2"},z=(0,a._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),L={class:"mb-2"},q=(0,a._)("label",{for:"email",class:"form-label"},"Email",-1),F={class:"mb-2"},N=(0,a._)("label",{for:"address",class:"form-label"},"收件人地址",-1),E={class:"mb-2"},I=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),O={class:"text-end"},H=["disabled"];function P(e,t,s,P,S,Y){const Z=(0,a.up)("dog-side-icon"),B=(0,a.up)("loading"),K=(0,a.up)("BIconLightningChargeFill"),M=(0,a.up)("Field"),A=(0,a.up)("ErrorMessage"),G=(0,a.up)("Form");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(B,{active:S.isLoading,class:"fs-1 text-secondary"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z),(0,a.Wm)(Z),(0,a.Wm)(Z)])),_:1},8,["active"]),(0,a._)("div",r,[i,(0,a._)("div",c,[(0,a._)("div",d,[n,(0,a._)("table",m,[u,S.cartData.carts?((0,a.wg)(),(0,a.iD)("tbody",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(S.cartData.carts,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",h,[(0,a._)("div",{class:"rounded rounded-3",style:(0,l.j5)([{height:"100px",width:"100px","background-position":"center center","background-size":"cover"},{backgroundImage:`url(${t.product.imageUrl})`}])},null,4)]),(0,a._)("td",f,(0,l.zw)(t.product.title),1),(0,a._)("td",_,(0,l.zw)(t.qty),1),(0,a._)("td",b," NT"+(0,l.zw)(e.$filters.toThousands(t.total)),1)])))),128))])):(0,a.kq)("",!0)]),(0,a._)("div",g,[(0,a._)("div",v,[(0,a._)("div",y,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠卷","aria-label":"請輸入優惠卷","aria-describedby":"button-addon2","onUpdate:modelValue":t[0]||(t[0]=e=>S.coupon=e)},null,512),[[o.nr,S.coupon]]),(0,a._)("button",{class:"btn btn-secondary",type:"button",id:"button-addon2",onClick:t[1]||(t[1]=(...e)=>Y.useCoupon&&Y.useCoupon(...e))}," 輸入優惠卷 ")])]),(0,a._)("div",x,[S.cartData.final_total===S.cartData.total?((0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("p",null,"總金額 : NT"+(0,l.zw)(e.$filters.toThousands(S.cartData.total))+" 元",1)])):((0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("del",C," 總計 : NT"+(0,l.zw)(e.$filters.toThousands(S.cartData.total))+" 元 ",1),(0,a._)("p",null,"折扣後金額 : NT"+(0,l.zw)(e.$filters.toThousands(S.cartData.final_total))+" 元",1)]))])]),(0,a._)("div",null,[(0,a._)("p",D,[(0,a.Wm)(K),V])])]),(0,a._)("div",W,[T,(0,a.Wm)(G,{ref:"form",onSubmit:Y.createToOrder},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",$,[U,(0,a.Wm)(M,{id:"name",name:"姓名",type:"text",placeholder:"請輸入姓名",rules:"required",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),modelValue:S.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>S.form.user.name=e)},null,8,["modelValue","class"]),(0,a.Wm)(A,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",j,[z,(0,a.Wm)(M,{id:"tel",name:"電話",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:Y.isPhone,modelValue:S.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>S.form.user.tel=e)},null,8,["class","rules","modelValue"]),(0,a.Wm)(A,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",L,[q,(0,a.Wm)(M,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:S.form.user.email,"onUpdate:modelValue":t[4]||(t[4]=e=>S.form.user.email=e)},null,8,["class","modelValue"]),(0,a.Wm)(A,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",F,[N,(0,a.Wm)(M,{id:"address",name:"地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:S.form.user.address,"onUpdate:modelValue":t[5]||(t[5]=e=>S.form.user.address=e)},null,8,["class","modelValue"]),(0,a.Wm)(A,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",E,[I,(0,a.wy)((0,a._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[6]||(t[6]=e=>S.form.message=e)},null,512),[[o.nr,S.form.message]])]),(0,a._)("div",O,[(0,a._)("button",{type:"submit",class:"btn btn-danger",disabled:Object.keys(e).length>0||0===S.cartData.carts.length},"送出訂單",8,H)])])),_:1},8,["onSubmit"])])])])],64)}var S=s(4051),Y={inject:["emitter"],data(){return{cartData:{carts:[]},form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon:"",isLoading:!1}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/cart";this.isLoading=!0,this.$http.get(e).then((e=>{setTimeout((()=>{this.isLoading=!1}),1e3),this.cartData=e.data.data}))},createToOrder(){const e="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/order",t=this.form;this.isLoading=!0,this.$http.post(e,{data:t}).then((e=>{setTimeout((()=>{this.isLoading=!1}),1e3),e.data.success&&this.emitter.emit("push-message",{style:"primary",title:"訂單建立成功"}),this.$refs.form.resetForm(),this.getCart(),this.form.message="",S.Z.emit("get-cart"),this.$router.push(`/pay/${e.data.orderId}`)})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"訂單建立失敗"})}))},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},useCoupon(){const e="https://vue3-course-api.hexschool.io/v2/api/yusyuanjhou/coupon",t={code:this.coupon};this.$http.post(e,{data:t}).then((e=>{this.getCart(),e.data.success&&this.emitter.emit("push-message",{style:"primary",title:"套用優惠卷成功"})})).catch((()=>{this.emitter.emit("push-message",{style:"danger",title:"套用優惠卷失敗"})}))}},mounted(){this.getCart()}},Z=s(3744);const B=(0,Z.Z)(Y,[["render",P]]);var K=B}}]);
//# sourceMappingURL=294.e8eef9d2.js.map